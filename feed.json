{
    "version": "https://jsonfeed.org/version/1",
    "title": "GSociety",
    "description": "",
    "home_page_url": "https://gsociety.fr",
    "feed_url": "https://gsociety.fr/feed.json",
    "user_comment": "",
    "author": {
        "name": "Guisch"
    },
    "items": [
        {
            "id": "https://gsociety.fr/how-my-own-domain-got-hijacked-on-github-pages/",
            "url": "https://gsociety.fr/how-my-own-domain-got-hijacked-on-github-pages/",
            "title": "The Great Subdomain Heist",
            "summary": "I was deep into an intense Helldivers 2 session when Google Search&hellip;",
            "content_html": "<p class=\"my-0\">I was deep into an intense Helldivers 2 session when Google Search Console notifications interrupted my battle against the alien hordes. Someone had claimed ownership of a subdomain I didn't even know existed: <code>ftp.malvetro.corsica</code>.</p>\n<p class=\"my-0\">Within minutes, I went from fighting digital aliens to investigating a real security incident, one that would eventually reveal a massive vulnerability affecting thousands of domains worldwide. More concerning? GitHub knows about it and isn't fixing it.</p>\n<h1 id=\"the-initial-discovery\" class=\"mb-2 mt-6 text-lg font-[500] first:mt-0 dark:font-[475]\">The Initial Discovery</h1>\n<p class=\"my-0\">Opening the suspicious subdomain revealed a gaudy online gambling site plastered across what should have been my family's vacation rental website. My first instinct: someone had compromised my domain registrar account. But the truth turned out to be more insidious.</p>\n<pre class=\"language-bash\"><code>$ dig malvetro.corsica +noall +answer -t A\nmalvetro.corsica. 442 IN A 185.199.110.153\nmalvetro.corsica. 442 IN A 185.199.109.153\nmalvetro.corsica. 442 IN A 185.199.108.153\nmalvetro.corsica. 442 IN A 185.199.111.153</code></pre>\n<p>Those IP addresses were familiar—they belong to GitHub Pages. My root domain (<code>malvetro.corsica</code>) was legitimately pointing there for my GitHub Pages site. But I'd never configured the <code>ftp</code> subdomain. Checking my DNS records at OVH revealed something disturbing:</p>\n<div class=\"w-full md:max-w-[90vw]\">\n<div class=\"codeWrapper text-textMainDark selection:!text-superDark selection:bg-superDuper/10 bg-offset dark:bg-offsetDark my-md relative flex flex-col rounded font-mono text-sm font-thin\">\n<div class=\"translate-y-xs -translate-x-xs bottom-xl mb-xl sticky top-0 flex h-0 items-start justify-end\">\n<div class=\"flex items-center min-w-0 font-medium gap-1.5 justify-center\">\n<div class=\"flex shrink-0 items-center justify-center size-4\"> </div>\n</div>\n</div>\n<div class=\"-mt-xl\">\n<div> </div>\n<div class=\"pr-lg\">\n<pre class=\"language-bash\"><code>$ dig ftp.malvetro.corsica +noall +answer -t CNAME\nftp.malvetro.corsica. 430 IN CNAME malvetro.corsica.</code></pre>\n</div>\n</div>\n</div>\n</div>\n<p class=\"my-0\">This CNAME record had been created automatically by my registrar without my knowledge, pointing to my main domain. Since my main domain used GitHub Pages, anyone could claim this subdomain by creating their own GitHub Pages site with the same subdomain in their repository's CNAME file.</p>\n<p class=\"my-0\"><strong>This wasn't a sophisticated hack—it was a systematic exploitation of common DNS practices, GitHub Pages configuration, and lack of domain verification.</strong></p>\n<h1 id=\"down-the-rabbit-hole\" class=\"mb-2 mt-6 text-lg font-[500] first:mt-0 dark:font-[475]\">Down the Rabbit Hole</h1>\n<p class=\"my-0\">To understand the scope, I needed to see if this was an isolated incident or part of a pattern. Searching GitHub for \"HANTUSLOT\" (the gambling site name) revealed several repositories using the same template across various subdomains.</p>\n<p class=\"my-0\">But GitHub's search was too limited for a comprehensive analysis. I turned to the GitHub CLI to dig deeper:</p>\n<div class=\"w-full md:max-w-[90vw]\">\n<div class=\"codeWrapper text-textMainDark selection:!text-superDark selection:bg-superDuper/10 bg-offset dark:bg-offsetDark my-md relative flex flex-col rounded font-mono text-sm font-thin\">\n<div class=\"-mt-xl\">\n<div class=\"text-text-200 bg-background-300 py-xs px-sm inline-block rounded-br rounded-tl-[3px] font-thin\">\n<pre class=\"language-bash\"><code># Search for repo owners with \"ftp.\" in repo names\n$ (gh search repos ftp --sort updated --limit 1000 | while read -r repo _; \n   do if [ $(echo \"$repo\" | grep -E \"\\/ftp\\.\") ]; \n      then echo $repo | cut -d/ -f1; \n   fi; done) | sort -u &gt; accounts\n\n# Clone all repositories from these users\n$ while read -r user; do \n    gh repo list \"$user\" --limit 1000 | \n    while read -r repo _; do \n      mkdir -p \"$user\"; \n      git clone \"https://github.com/$repo\" \"$repo\"; \n    done; \n  done &lt; accounts</code></pre>\n</div>\n</div>\n</div>\n</div>\n<p class=\"my-0\">To catch repos that might have been deleted (like the one targeting my domain), I improved the script to mirror-clone repositories and analyze their historical CNAME files:</p>\n<pre class=\"language-bash\"><code># Mirror clone all repos to get full history\n$ while read -r user; do \n    gh repo list \"$user\" --limit 1000 | \n    while read -r repo _; do \n      mkdir -p \"$user\"; \n      GIT_TERMINAL_PROMPT=0 git clone --mirror \"https://github.com/$repo\" \"$repo.mirror\"; \n    done; \n  done &lt; accounts\n\n# Extract all domain additions from CNAME files in git history\n$ (TMP=$(pwd); for f in $(find $(pwd) -maxdepth 2 -mindepth 2 -type d); do \n     cd $f; \n     git log -p --follow --all -- CNAME | grep -E \"^\\+[a-zA-Z0-9]\" | sed 's/^+//'; \n   done; \n   cd $TMP;) | sort -u &gt; subdomains\n\n# Analyze frequency of subdomain prefixes\n$ cat subdomains | cut -d. -f1 | sort | uniq -c | sort -n\n[...]\n      5 status\n      6 blog\n      6 depo10bonus10\n      6 depo20bonus20\n      6 linkserverinternasional\n      6 linkservervietnam\n      7 beta\n      7 docs\n      7 linkserverasia\n      7 linkserversensasional\n      8 cpanel\n      8 test\n     13 duit188\n     13 whm\n     26 webmail\n     37 www\n     48 mail\n   2091 ftp</code></pre>\n<p class=\"my-0\">The results were staggering. The frequency analysis revealed <strong>2091 instances of \"ftp\" subdomains</strong> being targeted. Other common targets included \"mail\" (48 instances), \"www\" (37), \"webmail\" (26), and other standard subdomains often created by default by domain registrars.</p>\n<h1 id=\"taking-it-to-the-next-level\" class=\"mb-2 mt-6 text-lg font-[500] first:mt-0 dark:font-[475]\">Taking It to The Next Level</h1>\n<p class=\"my-0\">The scale of this vulnerability demanded a more comprehensive approach. I developed a custom tool that:</p>\n<ol class=\"marker:text-textOff list-decimal\">\n<li>\n<p class=\"my-0\">Used public reverse DNS data to identify all domains and subdomains pointing to GitHub Pages IPs</p>\n</li>\n<li>\n<p class=\"my-0\">Checked which ones could be claimed through GitHub Pages</p>\n</li>\n<li>\n<p class=\"my-0\">Systematically identified vulnerable domains and subdomains</p>\n</li>\n</ol>\n<p class=\"my-0\">The result? I was able to take over approximately <strong>4,000 domains and subdomains</strong> in less than three weeks before GitHub banned my account.</p>\n<p class=\"my-0\">While the ban was technically justified under their Acceptable Use Policy, I hadn't been using these takeovers for malicious purposes. In fact, I redirected affected users to GitHub's documentation on how to regain control of their domains.</p>\n<p class=\"my-0\"><strong>I had already reported this vulnerability to GitHub via HackerOne in March 2024, but their response was dismissive:</strong></p>\n<blockquote>\n<p class=\"my-0\">\"We have determined that it is a known issue that does not present a significant security risk. We may make this functionality more strict in the future, but we don't have anythingto announce right now.</p>\n</blockquote>\n<p class=\"my-0\">A year later, in May 2025, nothing has changed.</p>\n<h1 id=\"why-this-matters-the-anatomy-of-a-subdomain-takeov\" class=\"mb-2 mt-6 text-lg font-[500] first:mt-0 dark:font-[475]\">Why This Matters: The Anatomy of a Subdomain Takeover</h1>\n<p class=\"my-0\">The vulnerability pattern follows a predictable flow:</p>\n<ol class=\"marker:text-textOff list-decimal\">\n<li>\n<p class=\"my-0\"><strong>Domain owner sets up GitHub Pages</strong> for their main domain (e.g., <code>example.com</code>)</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Registrar automatically creates additional subdomains</strong> (e.g., <code>ftp.example.com</code>) with CNAME records pointing to the main domain</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>GitHub allows anyone to claim any subdomain</strong> without verifying ownership or alerting the main domain owner</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Attackers discover and exploit</strong> these dangling subdomains</p>\n</li>\n</ol>\n<p class=\"my-0\">The worst cases involved wildcard CNAME records that redirected any subdomain to the main domain, making infinite subdomain takeovers possible.</p>\n<h1 id=\"the-security-implications-are-severe\" class=\"mb-2 mt-6 text-lg font-[500] first:mt-0 dark:font-[475]\">The Security Implications Are Severe</h1>\n<p class=\"my-0\">Subdomain takeovers enable attackers to:</p>\n<ol class=\"marker:text-textOff list-decimal\">\n<li>\n<p class=\"my-0\"><strong>Host malicious content</strong> under your trusted domain</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Capture cookies</strong> set for your domain</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Perform cross-site scripting attacks</strong></p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Damage brand reputation</strong> through phishing or scam sites</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Bypass certain security controls</strong> that trust your domain</p>\n</li>\n</ol>\n<p class=\"my-0\">For organizations using GitHub Pages, this represents a significant, unaddressed security risk hiding in plain sight.</p>\n<h1 id=\"recommendations-a-shared-responsibility\" class=\"mb-2 mt-6 text-lg font-[500] first:mt-0 dark:font-[475]\">Recommendations: A Shared Responsibility</h1>\n<h2 class=\"mb-xs mt-5 text-base font-[500] first:mt-0 dark:font-[475]\">For Domain Owners and Security Teams:</h2>\n<ol class=\"marker:text-textOff list-decimal\">\n<li>\n<p class=\"my-0\"><strong>Audit all your DNS records</strong>, particularly automatically created subdomains</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Remove unnecessary CNAME records</strong> pointing to your main domain</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Set up Google Search Console</strong> with domain verification to be alerted of ownership claims</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Verify custom domains for GitHub Pages</strong> using GitHub's verification system</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Monitor for new subdomains</strong> on an ongoing basis</p>\n</li>\n</ol>\n<h2 class=\"mb-xs mt-5 text-base font-[500] first:mt-0 dark:font-[475]\">For GitHub:</h2>\n<ol class=\"marker:text-textOff list-decimal\">\n<li>\n<p class=\"my-0\"><strong>Implement proper domain verification</strong> before allowing Pages to be published</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Alert domain owners</strong> when a subdomain of their verified domain is claimed by another user</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Proactively scan</strong> for and prevent obvious takeover attempts</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Take vulnerability reports seriously</strong> rather than dismissing documented risks</p>\n</li>\n</ol>\n<h2 class=\"mb-xs mt-5 text-base font-[500] first:mt-0 dark:font-[475]\">For Registrars (like OVH):</h2>\n<ol class=\"marker:text-textOff list-decimal\">\n<li>\n<p class=\"my-0\"><strong>Stop creating DNS records by default</strong> without clear user notification</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Warn users</strong> about potential security implications of default subdomain creation</p>\n</li>\n<li>\n<p class=\"my-0\"><strong>Implement verification steps</strong> for subdomain creation</p>\n</li>\n</ol>\n<h1 id=\"the-big-picture\" class=\"mb-2 mt-6 text-lg font-[500] first:mt-0 dark:font-[475]\">The Big Picture</h1>\n<p class=\"my-0\">This issue represents a classic case of responsibility diffusion. GitHub claims it's the domain owners' responsibility to verify their domains. Domain registrars create potentially vulnerable subdomains without warning. Domain owners often don't know what they don't know.</p>\n<p class=\"my-0\">Meanwhile, attackers are systematically exploiting this gap—I personally identified and could have maliciously taken over 4,000 domains with minimal effort. The real number of vulnerable domains is likely much higher.</p>\n<p class=\"my-0\">What's most concerning is GitHub's dismissal of the issue as not presenting \"a significant security risk,\" when the evidence clearly suggests otherwise. This highlights a troubling disconnect between security researchers identifying real-world vulnerabilities and platform providers willing to address them.</p>\n<p class=\"my-0\">Until GitHub implements proper verification, the burden falls on security teams to regularly audit their DNS configurations and monitor for subdomain takeovers. Sometimes security isn't about sophisticated zero-days—it's about checking your DNS records for the digital equivalent of unlocked doors.</p>",
            "image": "https://gsociety.fr/media/posts/2/ChatGPT-Image-22-mai-2025-01_06_22.png",
            "author": {
                "name": "Guisch"
            },
            "tags": [
                   "subdomaintakeover",
                   "infosec",
                   "githubpages",
                   "dns",
                   "cybersecurity",
                   "bugbounty"
            ],
            "date_published": "2025-05-18T23:07:41+02:00",
            "date_modified": "2025-05-22T01:10:42+02:00"
        }
    ]
}
